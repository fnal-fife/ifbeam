#export IFDH_BASE_URI="https://fermicloud083.fnal.gov:4430/sam/minerva/dev/api"
#export IFDH_BASE_URI="http://samweb.fnal.gov:8480/sam/minerva/api"
export IFDH_BASE_URI="http://samweb.fnal.gov:8480/sam/nova/api"

ifdh locateFile  "MV_00003142_0014_numil_v09_1105080215_RawDigits_v1_linjc.root"

ifdh describeDefinition  "mwm_test_2"

projname=mwm_`date +%Y%m%d%H`_$$

cpurl=`ifdh startProject $projname  minerva mwm_test_2 mengel minerva | tail -1`

sleep 2

cpurl=`ifdh findProject  $projname minerva | tail -1`

consumer_id=`ifdh establishProcess $cpurl demo 1 bel-kwinith.fnal.gov mengel "" "" "" | tail -1`

furi=`ifdh getNextFile $cpurl $consumer_id | tail -1`

fname=`ifdh fetchInput $furi | tail -1`

# udpateFileStatus is failing, but looks right...

ifdh updateFileStatus $cpurl  $consumer_id $fname transferred

sleep 1

ifdh updateFileStatus $cpurl  $consumer_id $fname consumed

furi=`ifdh getNextFile $cpurl $consumer_id | tail -1`

fname=`ifdh fetchInput $furi | tail -1`

ifdh updateFileStatus $cpurl  $consumer_id $fname skipped

ifdh setStatus $cpurl $consumer_id  bad

ifdh endProject $cpurl 

exit

ToDo
----
addOutputFile
copyBackOutput
